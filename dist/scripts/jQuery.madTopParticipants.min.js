/**********************************************************************\
*
*	jQuery.madTopParticipants
*	----------------------
*	version: 2.0.5
*	date: 2021/06/10
*	license: GPL-3.0-or-later
*	copyright (C) 2021 Brian Patrick Mucha
*
\**********************************************************************/

!function(a){"use strict";function t(t,e){var n=[],i=[];a.each(e.fr_ids,function(t,o){var r="method=getTopParticipantsData&v=1.0&api_key="+e.apiKey+"&response_format=json&suppress_response_codes=true&fr_id="+o,s=e.proxyURL+escape(e.secureConvioPath+"CRTeamraiserAPI?"+r),l=a.getJSON(s,function(a){i.push(a)});n.push(l)}),a.when.apply(a,n).then(function(){var n=[];Array.prototype.slice.call(arguments,0);a.each(i,function(a,t){if(t.getTopParticipantsDataResponse&&t.getTopParticipantsDataResponse.teamraiserData){var e;for(e=0;e<t.getTopParticipantsDataResponse.teamraiserData.length;e++)t.getTopParticipantsDataResponse.teamraiserData[e].total_num=Number(t.getTopParticipantsDataResponse.teamraiserData[e].total.replace(/[^0-9.-]+/g,""));n=[].concat(n,t.getTopParticipantsDataResponse.teamraiserData)}}),function(t,e,n){if(t.errorResponse)e.html('<div class="search_loading">('+t.errorResponse.message+")</div>");else{a(e).empty();var i=function(a,t,e){if(0===arguments.length)return[];if(1===arguments.length){if(null==a)return[];if(Array.isArray(a))return a}return Array.prototype.slice.call(arguments)}(t);a(i).length>0?(i.sort(function(a,t){return a.total_num<t.total_num?1:a.total_num>t.total_num?-1:0}),a.each(i,function(a,t){var i,o,r,s,l,p=document.getElementById(n.results_template_id),c=p.innerHTML;if(o=this.id,r=this.name,s=this.total,1==n.fr_ids.length&&(l=n.nonsecureConvioPath+"TR"+(n.folderPath?n.folderPath:"")+"?px="+this.id+"&pg=personal&fr_id="+n.fr_ids[0]),i=c.replace(/%%id%%/g,o).replace(/%%name%%/g,r).replace(/%%total%%/g,"$"+s).replace(/%%link%%/g,l),e.append(i),a==n.maxCount)return!1})):e.html('<div class="search_loading">(end of list)</div>'),n.callBack&&n.callBack()}}(n,t,e)}).fail(function(){window.console&&console.error("Top Participants: unsuccessful")})}var e={},n={fr_ids:[],maxCount:10,folderPath:null,loadingImage:null,loadingImageAlt:null,loadingText:null,callback:function(){}},i={init:function(i){(function(t,e){a(".search_item").remove(),e.loadingImage&&e.loadingText?t.append('<div class="list_loading"><img alt="'+e.loadingImageAlt+'" src="'+e.loadingImage+'" />'+e.loadingText+"</div>"):e.loadingImage?t.append('<div class="list_loading"><img alt="'+e.loadingImageAlt+'" src="'+e.loadingImage+'" /></div>'):e.loadingText&&t.append('<div class="list_loading">'+e.loadingText+"</div>")})(this,e=a.extend({},n,i)),this.data("settings",e),t(this,e)}};a.fn.madTopParticipants=function(t){return i[t]?i[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void a.error("Method "+t+" does not exist on jQuery.madTopParticipants"):i.init.apply(this,arguments)}}(jQuery);
